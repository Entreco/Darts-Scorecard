
/*
* Gets the version name from the latest Git tag
*/
def getGitTag = { ->
    try {
        def stdout = new ByteArrayOutputStream()
        exec {
            commandLine 'git', 'describe'
            standardOutput = stdout
        }
        return "v" + stdout.toString().trim()
    } catch (Throwable ignore){
        return "local"
    }
}

def getGitCommit = { ->
    def stdout = new ByteArrayOutputStream()
    exec {
        commandLine 'git', 'describe', '--always'
        standardOutput = stdout
    }
    return stdout.toString().trim()
}

def getBranchName = { ->
    def stdout = new ByteArrayOutputStream()
    exec {
        commandLine 'git', 'describe', '--always'
        standardOutput = stdout
    }
    return stdout.toString().trim()
}

def getVersionCode = { ->
    return (int)(((new Date().getTime()/1000) - 1510351372) / 10)
}

ext {

    kotlinVersion = '1.1.51'
    gradleVersion = '3.0.0'

    androidBuildToolsVersion = '26.0.2'
    androidCompileSdkVersion = 26
    androidMinSdkVersion = 23
    androidTargetSdkVersion = 26

    versionCode = getVersionCode()
    versionName = "${getGitTag()}-R-${getGitCommit()}"

    dependencies = [
            support = '27.0.0',
            constraint = '1.0.2',
            junit = '4.12',
            espressoCore = '3.0.1',
            espressoRunner = '1.0.1'
    ]
}