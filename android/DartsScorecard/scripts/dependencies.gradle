ext.gitTag = { ->
    try {
        def stdout = new ByteArrayOutputStream()
        exec {
            commandLine 'git', 'describe', '--tags', '--abbrev=0'
            standardOutput = stdout
        }
        return "v" + stdout.toString().trim()
    } catch (Throwable ignore) {
        return "local"
    }
}

ext.gitCommit = { ->
    def stdout = new ByteArrayOutputStream()
    exec {
        commandLine 'git', 'rev-parse', '--short=6', 'HEAD'
        standardOutput = stdout
    }
    return stdout.toString().trim()
}

ext.branchName = { ->
    return "Chisnall"
}

ext.versionCode = { ->
    return (int) (((new Date().getTime() / 1000) - 1510351372) / 10)
}

ext.versionName = { ->
    return "${gitTag()}-${branchName()}-${gitCommit()}"
}


ext {
    kotlinVersion = '1.2.40'
    gradleVersion = '3.1.2'
    gmsVersion = '3.2.0'
    dexCountVersion = '0.8.2'
    detektVersion = '1.0.0.RC6-3'
    jacocoCoverageVersion = '0.4.0'
    coverallsVersion = '2.8.2'
    fabricVersion = '1.25.1'

    androidBuildToolsVersion = '27.0.3'
    androidCompileSdkVersion = 27
    androidMinSdkVersion = 23
    androidTargetSdkVersion = 27

    versionCode = versionCode()
    versionName = versionName()

    dependencies = [
            support = '27.1.1',
            daggerVersion = '2.13',
            constraint = '1.1.0',
            architecture = '1.1.1',
            room = '1.0.0',
            firebase = '15.0.0',
            picasso = '2.71828',
            circleImageView = '2.2.0',
            crash = '2.9.1@aar',
            gson = '2.8.2',
            junit = '4.12',
            mockito = '2.12.0',
            mockitoKotlin = '1.5.0',
            espressoCore = '3.0.1',
            espressoRunner = '1.0.1'
    ]
}
